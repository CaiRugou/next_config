---
title: 梯度下降法
date: 2016-04-15 18:10:11
tags:
---

*梯度下降法(gradient descent)或者最速下降法(steepest descent)是求解无约束最优化问题的一种最为常用的方法。梯度下降法是迭代算法，每一步需要求解目标函数的梯度向量。*

## 梯度下降法

输入：目标函数$f(x)$，梯度函数$g(x)=▽f(x)$，计算精度$ε$；
输出：$f(x) $的极小点$x^* $

(1) 取出初始值 $x^{(0)} ∈ R^n $, 置$k = 0$
(2) 计算$ f(x^{(k)})$
(3) 计算$g_k = g(x^{(k)})$, 当$||g_k||< ε$时，停止迭代,令$x^* = x^{(k)}$；否则，令 $p_k=-g(x^{(k)})$（这里注意是梯度上升的反方向），求 $λ_k$，使

$$f(x^{(k)}+λpk)=\min{λ≥0} f( x^{(k)}+λ p_k )$$

(4) 置$x^{(k+1)}= x^{(k)}+λp_k$，计算$f(x^{(k+1)})$ 当$||f(x^{(k+1)})||<ε$或者$||x^{(k+1)}-x^{(k)}||<ε$时，停止迭代，令$x^* = x^{(k)}$；

(5) 否则，置$k=k+1$，转为步骤（3）。

当目标函数是凸函数时，梯度下降 法的解是全局最优解，更为一般的情况下，并不保证是全局最优解。其收敛速度也不一定是最快的。

例题解析
已知初始值$x_0=(1,1)$，用最速下降法求解目标函数$f(x) = 4x_1+6x_2-2x_1^2-2x_1x_2-2x_2^2$的极大值，则迭代一次后$x_1$的值。

解：
得到目标函数的梯度函数：
$$\dfrac{∂f}{∂x_1} = 4-4x_1-2x_2$$

$$\dfrac{∂f}{∂x_1} = 6-4x_2-2x_1$$

求$g_k$得到：$g_k=g(x^{(k=0)})$，故有$p_k=(2,0)$

$$\dfrac{∂f}{∂x_1} = 4-4×1-2×1=2$$

$$\dfrac{∂f}{∂x_1} = 6-4×1-2×1=0$$

.2.进行下一次迭代即$x^{(k+1)}$，先要得到最优步长$λ_k$
这里要求的是极大值故为$p_k$，如果是极小值$-p_k$

$$f(x^{(k)}+λ_k p_k) = f((1,1)+λ_0(2,0))=-2(1-λ_0)^2-4λ_0+6$$

为了求最优步长故对$g_k$求偏倒：

$${g_k}^{(')}=\dfrac{∂g_k}{∂λ_k} = 8(1-2λ_k)$$

$${g_0}^{(')}=\dfrac{∂g_0}{∂λ_0} = 8(1-2λ_0)=0$$

得到$λ_0=0.5$

3.带入最优更新步长得到
$$x^{(k+1)}=x^{(k)}+λ_k p_k$$

$$x^{(0+1)}=x^{(0)}+λ_0 p_0=((1-2λ_0),1)=(0.5,1)$$

最终得到迭代$x^{(1)} = (0.5,1)$

当达到某一精度我们可以停止这一迭代过程。

